---
id: "flow-create-stream"
sidebar_position: 3
title: "Flow Create Stream"
---

import AdmonitionSimpleCode from "@site/docs/snippets/AdmonitionSimpleCode.mdx";

# Create a Flow stream

Flow is a stream with an indefinitely period of time, which will accumulate debt if not funds are deposited. In this
guide, we will show you how to programmatically create a Flow stream.

This guide assumes that you have already gone through the [Calculate Rate Per Second](./02-calculate-rps.mdx) section.

<AdmonitionSimpleCode />

## Set up a contract

Declare the Solidity version used to compile the contract:

```solidity
pragma solidity >=0.8.22;
```

Import the relevant symbols from `@sablier/flow`, and the `FlowUtilities` library:

```solidity
import { IERC20 } from "@openzeppelin/contracts/token/ERC20/IERC20.sol";
import { UD21x18 } from "@prb/math/src/UD21x18.sol";
import { ISablierFlow } from "@sablier/flow/src/interfaces/ISablierFlow.sol";

import { FlowUtilities } from "./FlowUtilities.sol";
```

Create a contract called `FlowStreamCreator`, and declare a constant `USDC` of type `IERC20` and a constant `FLOW` of
type `ISablierFlow`:

```solidity
contract FlowStreamCreator {
    IERC20 public constant USDC = IERC20(0xf08A50178dfcDe18524640EA6618a1f965821715);
    ISablierFlow public constant FLOW = ISablierFlow(0x3a1beA13A8C24c0EA2b8fAE91E4b2762A59D7aF5);
}
```

In the code above, the contract addresses are hard-coded for demonstration purposes. However, in production, you would
likely use input parameters to allow flexibility in changing the addresses.

Also, these addresses are deployed on Sepolia. If you need to work with a different chain, the Sablier addresses can be
obtained from the [Deployment Addresses](/guides/flow/deployments) page.

We will declare two functions, based on the amout desired to stream over a period of time.

## Function definition

Define a function to pay a salary of 1,000 USD per month, call it `createStream_1K_PerMonth` which returns the ID of the
created stream:

```solidity
function createStream_1K_PerMonth() external returns (uint256) {
    // ...
}

```

## Parameters

### Rate Per Second

Use the `FlowUtilities` library to calculate the rate per second for the desired amount:

```solidity
UD21x18 ratePerSecond = FlowUtilities.ratePerSecondWithDuration({ token: address(USDC), amount: 1000e6, duration: 30 days });
```

### Sender

The address streaming the tokens, with the ability to `pause` the stream:

```solidity
sender = msg.sender
```

### Recipient

The address receiving the tokens:

```solidity
recipient = address(0xCAFE);
```

### Token

The contract address of the ERC-20 token used for streaming. In this example, we will stream `USDC`:

```solidity
token = USDC;
```

### Transferable

Boolean that indicates whether the stream will be transferable or not.

```solidity
transferable = true;
```

### Invoke the create function

With all the parameters, we can call the `create` function from the `FLOW` contract and assign the newly created stream
to the returned ID:

```solidity
streamId = FLOW.create({
    sender: msg.sender,
    recipient: address(0xCAFE),
    ratePerSecond: FlowUtilities.ratePerSecondWithDuration({ token: address(USDC), amount: 1000e6, duration: 30 days }),
    token: USDC,
    transferable: true
});
```

### The complete Flow stream creator contract

Below you can see the complete `FlowStreamCreator` contract:

```solidity reference title="Flow Stream Creator"
https://github.com/sablier-labs/examples/blob/feat/flow/flow/FlowStreamCreator.sol
```
