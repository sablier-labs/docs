---
id: "custom-deployments"
sidebar_position: 4
title: "Custom Deployments"
---

import { Links } from "@site/src/constants";

:::info[Reach Out]

{/* prettier-ignore */}
Want to get Sablier deployed on your chain? If you meet the requirements listed below, fill out <Link href={Links.Forms.CHAINS}>this
form</Link> and our team will get back to you.

:::

## Requirements

The Sablier Interface currently supports only The Graph and Envio indexer services. If you use a different indexer, you
can schedule a call <Link href={Links.Forms.CALL}>here</Link> to discuss integration.

- [x] GraphQL indexer: either [The Graph](https://thegraph.com) or [Envio](https://envio.dev)
- [x] Blockchain explorer with instructions for verifying contracts, e.g., [Etherscan](https://etherscan.io)
- [x] Functional JSON-RPC endpoint, ideally listed on [ChainList](https://chainlist.org)
- [x] Bridge, and instructions for how to obtain gas tokens (e.g., ETH) and ERC-20 tokens to the target chain
- [x] Support for [Shanghai](https://docs.soliditylang.org/en/latest/using-the-compiler.html#target-options) EVM version or later
- [x] Support for Solidity v0.8.22 or later

### Contracts

- [x] Foundry's [Deterministic Deployer](https://github.com/Arachnid/deterministic-deployment-proxy) contract at
      [`0x4e59b44847b379578588920cA78FbF26c0B4956C`](https://etherscan.io/address/0x4e59b44847b379578588920cA78FbF26c0B4956C)
- [x] [Multicall3](https://github.com/mds1/multicall) contract at
      [`0xcA11bde05977b3631167028862bE2a173976CA11`](https://etherscan.io/address/0xcA11bde05977b3631167028862bE2a173976CA11)

## Making a Deployment

:::warning[NOTE]

The rest of the guide applies ONLY IF you have been granted a
[BUSL license](https://app.ens.domains/license-grants.sablier.eth?tab=records) to deploy the protocol. Otherwise, this
section is not relevant to you.

:::

### Prerequisites

- Check if the deployments are not already made: [Airdrops](/guides/airdrops/deployments), [Flow](/guides/flow/deployments), [Lockup](/guides/lockup/deployments)
- Follow the contributing guides for <Link href={`${Links.GitHub.AIRDROPS}/blob/main/CONTRIBUTING.md`}>Airdrops</Link>, <Link href={`${Links.GitHub.FLOW}/blob/main/CONTRIBUTING.md`}>Flow</Link> and <Link href={`${Links.GitHub.LOCKUP}/blob/main/CONTRIBUTING.md`}>Lockup</Link>.
- RPC endpoint, e.g., a paid [Infura](https://www.infura.io/) or [Alchemy](https://www.alchemy.com/) account
- Have enough gas tokens (e.g., ETH) in your deployer account
- Have an Etherscan API key (for source code verification)

### Comptroller Deployment

#### Step 1: Clone the <Link href={Links.GitHub.EVMUTILS}>EVM Utils repo</Link> and checkout to the `v1.0.0` tag

```bash
git clone -b v1.0.0 git@github.com:sablier-labs/evm-utils.git
cd evm-utils
bun install --frozen-lockfile
```

#### Step 2: Create an `.env` file

```bash
touch .env
```

Add the following variables to `.env` file:

```
ETH_FROM="DEPLOYER ADDRESS"
ETHERSCAN_API_KEY="EXPLORER API KEY"
PRIVATE_KEY="PRIVATE KEY OF DEPLOYER ADDRESS"
RPC_URL="RPC ENDPOINT URL"
VERIFIER_URL="EXPLORER VERIFICATION URL"
```

Load the environment variables into your shell:

```bash
source .env
```

#### Step 3: Run the following deployment command

```bash
FOUNDRY_PROFILE=optimized \
forge script scripts/solidity/DeployDeterministicComptrollerProxy.s.sol:DeployDeterministicComptrollerProxy \
  --broadcast \
  --rpc-url $RPC_URL \
  --private-key $PRIVATE_KEY \
  --sig "run()" \
  --etherscan-api-key $ETHERSCAN_API_KEY \
  --verifier "etherscan" \
  --verify \
  -vvv
```

The above command works for etherscan equivalent explorers. If the chain uses a custom explorer,
modify the verifier arguments according to [forge script documentation](https://getfoundry.sh/forge/reference/script/#forge-script). You should
also refer to the forge script documentation for different wallet options such as mnemonic or hardware device.

#### Step 4: Update the EVM Utils repository

Add the chain ID of your newly deployed chain to the `ChainId` library in the [EVM Utils repo](https://github.com/sablier-labs/evm-utils/blob/d7d6c051a39cbacadef672e92ed9d57628c80dc4/src/tests/ChainId.sol). Then, bump the EVM Utils version in each protocol repository's `package.json` file (e.g., [Lockup](https://github.com/sablier-labs/lockup/blob/58eaac45c20c57a93b73d887c714e68f061ec3e6/package.json#L16), [Flow](https://github.com/sablier-labs/flow/blob/a4143de45478f508bca8305fec2bd81b7ad25fe9/package.json#L16), [Airdrops](https://github.com/sablier-labs/airdrops/blob/077c6b9766ef7693ba9e82a9e001dc0097709c01/package.json#L16)).

### Lockup Deployment

#### Step 1: Clone the <Link href={Links.GitHub.LOCKUP}>Lockup repo</Link> and checkout to the `v3.0.1` tag

```bash
git clone -b v3.0.1 git@github.com:sablier-labs/lockup.git
cd lockup
bun install --frozen-lockfile
```

#### Step 2: Create an `.env` file

```bash
touch .env
```

Add the following variables to `.env` file:

```
ETH_FROM="DEPLOYER ADDRESS"
ETHERSCAN_API_KEY="EXPLORER API KEY"
PRIVATE_KEY="PRIVATE KEY OF DEPLOYER ADDRESS"
RPC_URL="RPC ENDPOINT URL"
VERIFIER_URL="EXPLORER VERIFICATION URL"
```

Load the environment variables into your shell:

```bash
source .env
```

#### Step 3: Run the following deployment command

```bash
FOUNDRY_PROFILE=optimized \
forge script scripts/solidity/DeployDeterministicProtocol.s.sol:DeployDeterministicProtocol \
  --broadcast \
  --rpc-url $RPC_URL \
  --private-key $PRIVATE_KEY \
  --sig "run()" \
  --etherscan-api-key $ETHERSCAN_API_KEY \
  --verifier "etherscan" \
  --verify \
  -vvv
```

The above command works for etherscan equivalent explorers. If the chain uses a custom explorer,
modify the verifier arguments according to [forge script documentation](https://getfoundry.sh/forge/reference/script/#forge-script). You should
also refer to the forge script documentation for different wallet options such as mnemonic or hardware device.

### Merkle Airdrops Deployment

#### Step 1: Clone the <Link href={Links.GitHub.AIRDROPS}>Merkle Airdrops repo</Link> and checkout to `v2.0.1` tag

```bash
git clone -b v2.0.1 git@github.com:sablier-labs/airdrops.git
cd airdrops
bun install --frozen-lockfile
```

#### Step 2: Create an `.env` file

```bash
touch .env
```

Add the following variables to `.env` file:

```
ETH_FROM="DEPLOYER ADDRESS"
ETHERSCAN_API_KEY="EXPLORER API KEY"
PRIVATE_KEY="PRIVATE KEY OF DEPLOYER ADDRESS"
RPC_URL="RPC ENDPOINT URL"
VERIFIER_URL="EXPLORER VERIFICATION URL"
```

Load the environment variables into shell:

```bash
source .env
```

#### Step 3: Run the following command to deploy all merkle airdrop contracts

```bash
FOUNDRY_PROFILE=optimized \
forge script scripts/solidity/DeployDeterministicFactories.s.sol:DeployDeterministicFactories \
  --broadcast \
  --rpc-url $RPC_URL \
  --private-key $PRIVATE_KEY \
  --sig "run()" \
  --etherscan-api-key $ETHERSCAN_API_KEY \
  --verifier "etherscan" \
  --verify \
  -vvv
```

The above command works for etherscan equivalent explorers. If the chain uses a custom explorer,
modify the verifier arguments according to [forge script documentation](https://getfoundry.sh/forge/reference/script/#forge-script). You should
also refer to the forge script documentation for different wallet options such as mnemonic or hardware device.

### Flow Deployment

#### Step 1: Clone the <Link href={Links.GitHub.FLOW}>Flow repo</Link> and checkout to `v2.0.0` tag

```bash
git clone -b v2.0.0 git@github.com:sablier-labs/flow.git
cd flow
bun install --frozen-lockfile
```

#### Step 2: Create an `.env` file

```bash
touch .env
```

Add the following variables to `.env` file:

```
ETH_FROM="DEPLOYER ADDRESS"
ETHERSCAN_API_KEY="EXPLORER API KEY"
PRIVATE_KEY="PRIVATE KEY OF DEPLOYER ADDRESS"
RPC_URL="RPC ENDPOINT URL"
VERIFIER_URL="EXPLORER VERIFICATION URL"
```

Load the environment variables into your shell:

```bash
source .env
```

#### Step 3: Run the following deployment command

```bash
FOUNDRY_PROFILE=optimized \
forge script scripts/solidity/DeployDeterministicProtocol.s.sol:DeployDeterministicProtocol \
  --broadcast \
  --rpc-url $RPC_URL \
  --private-key $PRIVATE_KEY \
  --sig "run()" \
  --etherscan-api-key $ETHERSCAN_API_KEY \
  --verifier "etherscan" \
  --verify \
  -vvv
```

The above command works for etherscan equivalent explorers. If the chain uses a custom explorer,
modify the verifier arguments according to [forge script documentation](https://getfoundry.sh/forge/reference/script/#forge-script). You should
also refer to the forge script documentation for different wallet options such as mnemonic or hardware device.

### List your deployments

After the contracts are deployed, you can submit a PR in the <Link href={Links.GitHub.SDK}>SDK
repo</Link> by including the following details:

- Add the broadcast files (JSON) to <Link href={`${Links.GitHub.SDK}/tree/main/deployments`}>deployments</Link> directory.
- Add the deployment addresses to the following files:
  - <Link href={`${Links.GitHub.SDK}/blob/main/src/comptroller.ts`}>Comptroller Deployments</Link>
  - <Link href={`${Links.GitHub.SDK}/blob/main/src/releases/airdrops/v2.0/deployments.ts`}>Airdrops Deployments</Link>
  - <Link href={`${Links.GitHub.SDK}/blob/main/src/releases/flow/v2.0/deployments.ts`}>Flow Deployments</Link>
  - <Link href={`${Links.GitHub.SDK}/blob/main/src/releases/lockup/v3.0/deployments.ts`}>Lockup Deployments</Link>
